<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link href="/css/colors.css" rel="stylesheet">
    <link href="/css/general.css" rel="stylesheet">
</head>

<body>

    {{ template "www/ui/html-templates/login-dialog.html" }}
    {{ template "www/ui/html-templates/display-entry.html" }}
    {{ template "www/ui/html-templates/de-copies.html" }}
    {{ template "www/ui/html-templates/de-cost-calculation-modifiers.html" }}
    {{ template "www/ui/html-templates/de-descendants.html" }}
    {{ template "www/ui/html-templates/de-description.html" }}
    {{ template "www/ui/html-templates/de-notes.html" }}
    {{ template "www/ui/html-templates/de-requirements.html" }}
    {{ template "www/ui/html-templates/de-status-menu.html" }}
    {{ template "www/ui/html-templates/color-scheme-selector.html" }}

    <login-dialog></login-dialog>
    <color-scheme-selector style="display: none;"></color-scheme-selector>

    <template id="display-entry">
    </template>
    <div id="notifications" style="position: absolute;"></div>
</body>
<script>
    let mode_curWin = window
    function getAIOWeb(user) {
        return JSON.parse(user.Extra).AIOWeb || {}
    }
</script>
<script src="/config.js"></script>
<script src="/js/items.js"></script>
<script src="/js/api.js"></script>
<script src="/js/notes-parser.js"></script>
<script src="/ui/js_api.js"></script>
<!-- <script src="/ui/calculator.js"></script> -->
<script src="/ui/components.js"></script>
<script src="/ui/globals.js"></script>
<script src="/ui/sidebar.js"></script>
<script src="/ui/settings.js"></script>
<script src="/ui/view-modes/modes.js"></script>
<script src="/ui/view-modes/displayEntry.js"></script>
<script src="/ui/ui.js"></script>
<script>
    function updateInfo2() {
    }
    const urlParams = new URLSearchParams(document.location.search)
    let id = urlParams.get("item-id")

    fetch(`${apiPath}/get-all-for-entry?id=${id}&uid=0`).then(async (res) => {
        const template = document.getElementById("display-entry")

        let info, meta, user
        let events = []
        let text = (await res.text()).trim()
        for (let line of api_deserializeJsonl(text)) {
            if (probablyMetaEntry(line)) {
                meta = line
            } else if (probablyUserItem(line)) {
                user = line
            } else if (probablyInfoEntry(line)) {
                info = line
            } else {
                events.push(line)
            }
        }
        items_addItem({meta, events, info, user})
        items_setResults([BigInt(id)])
        const m = new DisplayMode(document.body)
        renderDisplayItem.call(m, meta.ItemId)
    })
</script>

</html>
